import{e as ce,h as ee,_ as ie}from"./index.70bdb397.js";/* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css                *//* empty css                *//* empty css               */import{d as ae,r as te,e as i,aK as x,B as o,aD as D,aG as t,aH as e,aM as u,aN as _,C as l,aE as g,bL as re,aV as T,bE as se,aW as oe,bb as ne,bH as ue,bS as pe,bF as _e,bG as le,c as K,u as v,F as de,E as me,aL as fe,aF as ye,bK as ke,bO as ve,bP as ge,bQ as be,bD as Ce,bB as Fe,bC as he}from"./arco.46b62ede.js";import{g as Be}from"./vue.4bab78c1.js";import{a as De,t as Ee,r as Ie}from"./task.f28b25f5.js";/* empty css              *//* empty css              *//* empty css               *//* empty css                */import{_ as xe}from"./index.vue_vue_type_script_setup_true_lang.e0cb0599.js";import{b as Ne}from"./replay.72c39936.js";import{_ as Ae}from"./index.vue_vue_type_script_setup_true_lang.7ecdc547.js";import{f as we,m as Se}from"./case.0ede9485.js";/* empty css                */import{_ as Te}from"./index.vue_vue_type_script_setup_true_lang.7a286740.js";import{u as $e}from"./loading.f82ebe9b.js";import"./chart.42ea7243.js";import"./base.3c7b4f95.js";/* empty css                */import"./module.bf6e4bd0.js";/* empty css               */const ze={key:0,style:{color:"green"}},Ue={key:1,style:{color:"#6e97b9"}},Le={key:2,style:{color:"green"}},Re={key:3,style:{color:"red"}},Ke={name:"TaskItemList"},G=ae({...Ke,props:{status:{type:String,default(){return"INIT"}},taskId:{type:String,default(){return""}}},setup(Y){const y=Y,V=te({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),N=i([]),d=i(!1),k=i(null),r=ce(),A={page:1,pageSize:20,showPageSize:!0},b=te({...A}),E=i([]),w=i(0),C=async(s={page:1,pageSize:20})=>{if(r.appName){const n={taskId:y.taskId,taskStatus:y.status,page:s.page,pageSize:s.pageSize},{data:F,count:p}=await De(n);w.value=p,E.value=F,b.page=s.page,b.total=p}},$=s=>{C({...A,page:s})},O=[{title:"caseId",slotName:"caseId"},{title:"caseName",dataIndex:"caseName"},{title:"\u72B6\u6001",dataIndex:"status",slotName:"status"},{title:"\u64CD\u4F5C",slotName:"button"},{title:"\u4E3B\u8C03\u7528",dataIndex:"entrance",slotName:"entranceDesc"}],P=s=>{const{href:n}=ee.resolve({path:`/test/case-detail/${s.appName}/${s.caseId}`});window.open(n,"_blank")},M=s=>{const{href:n}=ee.resolve({path:`/replay/detail/${s.appName}/${s.repeatId}`});window.open(n,"_blank")},H=(s,n)=>{Ne(n.appName,n.caseId,s.ip).then(F=>{window.open(`/#/replay/detail/${n.appName}/${F.data}`)})},Q=s=>{k.value=s,d.value=!0};let c=[];const Z=s=>{s.length>0?c=s:c=[]},W=()=>{re.warning({title:"\u5220\u9664\u786E\u8BA4",content:"\u5220\u9664\u52A8\u4F5C\u4E0D\u53EF\u9006\uFF0C\u8BF7\u786E\u8BA4\u4E4B\u540E\u518D\u64CD\u4F5C\uFF01",onOk:()=>{z()}})},z=()=>{if(c.length<=0){T.error("\u81F3\u5C11\u9009\u62E91\u4E2Acase\u8FDB\u884C\u5220\u9664");return}we(c,y.taskId).then(()=>{T.success("\u5220\u9664\u6210\u529F"),C()})};C();const S=i(!1),j=()=>{if(c.length<=0){T.warning("\u81F3\u5C11\u9009\u62E91\u4E2Acase\u8FDB\u884C\u79FB\u52A8");return}S.value=!0},U=async s=>{await Se(s.taskId,c,r.appName),T.success("\u79FB\u52A8\u6210\u529F"),await C(),N.value=[]};return(s,n)=>{const F=se,p=oe,q=ne,h=ue,I=pe,B=x("icon-loading"),J=x("icon-check-circle"),X=_e,L=le;return o(),D(h,null,{default:t(()=>[e(L,{span:24},{default:t(()=>[e(h,{style:{"margin-bottom":"5px"}},{default:t(()=>[e(q,null,{default:t(()=>[e(F,{checkable:"",color:"red","default-checked":!0},{default:t(()=>[u("\u5171\u8BA1"+_(w.value)+"\u4E2A",1)]),_:1}),e(p,{type:"primary",size:"mini",onClick:j},{default:t(()=>[u("\u79FB\u52A8")]),_:1}),e(p,{type:"primary",status:"danger",size:"mini",onClick:W},{default:t(()=>[u("\u5220\u9664")]),_:1})]),_:1})]),_:1}),e(X,{selectedKeys:N.value,"onUpdate:selectedKeys":n[0]||(n[0]=a=>N.value=a),size:"mini","row-key":"caseId",columns:O,data:E.value,pagination:b,"row-selection":V,onPageChange:$,onSelectionChange:Z},{caseId:t(({record:a})=>[e(I,{onClick:R=>P(a)},{default:t(()=>[u(_(a.caseId),1)]),_:2},1032,["onClick"])]),status:t(({record:a})=>[a.status==="RUNNING"?(o(),l("span",ze,[e(B),u("\u8FD0\u884C\u4E2D")])):g("",!0),a.status==="INIT"?(o(),l("span",Ue,[e(B),u("\u6392\u961F\u4E2D")])):g("",!0),a.status==="SUCCESS"?(o(),l("span",Le,[e(J),u("\u6210\u529F")])):g("",!0),a.status==="FAIL"?(o(),l("span",Re,"\u5931\u8D25")):g("",!0)]),entranceDesc:t(({record:a})=>[e(Ae,{"record-type":a.invokeType,"entrance-desc":a.entrance},null,8,["record-type","entrance-desc"])]),button:t(({record:a})=>[e(p,{type:"outline",size:"mini",shape:"round",style:{"margin-right":"5px"},onClick:R=>M(a)},{default:t(()=>[u(" \u8BE6\u60C5 ")]),_:2},1032,["onClick"]),e(p,{type:"outline",size:"mini",status:"warning",shape:"round",onClick:R=>Q(a)},{default:t(()=>[u(" \u91CD\u8BD5 ")]),_:2},1032,["onClick"])]),_:1},8,["selectedKeys","data","pagination","row-selection"])]),_:1}),e(xe,{visible:d.value,"onUpdate:visible":n[1]||(n[1]=a=>d.value=a),record:k.value,onOk:H},null,8,["visible","record"]),e(Te,{open:S.value,"onUpdate:open":n[2]||(n[2]=a=>S.value=a),onOk:U},null,8,["open"])]),_:1})}}}),Ge={class:"container"},Ve={key:0,style:{color:"green"}},Oe={key:1,style:{color:"#b3c7b3"}},Pe={key:2,style:{color:"green"}},Me={key:3,style:{color:"blue"}},He={key:4,style:{color:"green"}},Qe={key:5,style:{color:"red"}},We={key:6,style:{color:"blue"}},je={key:7,style:{color:"#9157c7"}},qe={key:8},Je={key:9},Xe={name:"TaskDetail"},Ye=ae({...Xe,setup(Y){const{loading:y,setLoading:V}=$e(!0),N=Be(),{taskId:d}=N.params,k=i("");typeof d=="string"&&(k.value=d);const r=i(),A=i(0),b=i(0),E=i(0),w=i(0),C=i(0),$=async()=>{const{data:c}=await Ee(d);r.value=c,A.value=c.total,E.value=c.fail,b.value=c.success,C.value=c.successRate,w.value=c.running,V(!1)},O=K(()=>`\u6210\u529F(${b.value})`),P=K(()=>`\u5931\u8D25(${E.value})`),M=K(()=>`\u8FD0\u884C\u4E2D(${w.value})`),H=K(()=>r.value?[{label:"\u5E94\u7528\u540D",key:"appName",value:r.value.appName},{label:"\u4EFB\u52A1\u540D\u79F0",key:"name",value:r.value.name},{label:"\u4EFB\u52A1\u72B6\u6001",key:"status",value:r.value.status},{label:"\u521B\u5EFA\u65F6\u95F4",key:"gmtCreate",value:r.value.gmtCreate},{label:"\u73AF\u5883",key:"env",value:r.value.env},{label:"\u542F\u52A8\u65F6\u95F4",key:"gmtStart",value:r.value.gmtStart}]:[]),Q=()=>{d&&Ie(d).then(()=>{T.success("\u91CD\u8BD5\u6210\u529F"),$()})};return $(),(c,Z)=>{const W=x("Breadcrumb"),z=fe,S=ye,j=oe,U=x("icon-loading"),s=x("icon-check-circle"),n=se,F=ke,p=le,q=x("icon-edit"),h=ve,I=ne,B=ge,J=be,X=ue,L=Ce,a=Fe,R=he;return o(),l("div",Ge,[e(W),e(S,null,{default:t(()=>[e(z,null,{default:t(()=>[u("\u4EFB\u52A1\u7BA1\u7406")]),_:1}),e(z,null,{default:t(()=>[u("\u4EFB\u52A1\u8BE6\u60C5")]),_:1})]),_:1}),e(L,{class:"general-card",title:"\u4EFB\u52A1\u8BE6\u60C5"},{extra:t(()=>[e(j,{type:"primary",status:"warning",onClick:Q},{default:t(()=>[u("\u91CD\u8DD1\u5931\u8D25")]),_:1})]),default:t(()=>[e(X,null,{default:t(()=>[e(p,{span:12},{default:t(()=>[e(F,{data:v(H),layout:"inline-horizontal",column:2},{value:t(({value:m,data:f})=>[f.value==="RUNNING"?(o(),l("span",Ve,[e(U),u("\u8FD0\u884C\u4E2D")])):f.value==="INIT"?(o(),l("span",Oe,[e(U),u("\u6392\u961F\u4E2D")])):f.value==="SUCCESS"?(o(),l("span",Pe,[e(s),u("\u6210\u529F")])):f.key==="total"?(o(),l("span",Me,_(m),1)):f.key==="success"?(o(),l("span",He,_(m),1)):f.key==="fail"?(o(),l("span",Qe,_(m),1)):f.key==="appName"?(o(),l("span",We,_(m),1)):f.key==="successRate"?(o(),l("span",je,_(m),1)):f.key==="env"?(o(),l("span",qe,[m==="DEV"?(o(),D(n,{key:0,color:"#ff5722",size:"small"},{default:t(()=>[u(_(m),1)]),_:2},1024)):(o(),D(n,{key:1,color:"#165dff",size:"small"},{default:t(()=>[u(_(m),1)]),_:2},1024))])):(o(),l("span",Je,_(m),1))]),_:1},8,["data"])]),_:1}),e(p,{span:12},{default:t(()=>[e(J,{cols:24,"row-gap":16,class:"panel"},{default:t(()=>[e(B,{class:"panel-col",span:{xs:12,sm:12,md:12,lg:12,xl:12,xxl:6}},{default:t(()=>[e(I,null,{default:t(()=>[e(h,{title:"\u7528\u4F8B\u603B\u6570",value:A.value,precision:0,"value-from":0,animation:"","show-group-separator":""},{prefix:t(()=>[de("span",{class:"statistic-prefix",style:me({background:"rgb(199 158 135)"})},[e(q)],4)]),_:1},8,["value"])]),_:1})]),_:1}),e(B,{class:"panel-col",span:{xs:12,sm:12,md:12,lg:12,xl:12,xxl:6}},{default:t(()=>[e(I,null,{default:t(()=>[e(h,{title:"\u7528\u4F8B\u6210\u529F\u6570",value:b.value,precision:0,"value-from":0,"value-style":{color:"#0fbf60"},animation:"","show-group-separator":""},null,8,["value"])]),_:1})]),_:1}),e(B,{class:"panel-col",span:{xs:12,sm:12,md:12,lg:12,xl:12,xxl:6}},{default:t(()=>[e(I,null,{default:t(()=>[e(h,{title:"\u7528\u4F8B\u5931\u8D25\u6570",value:E.value,precision:0,"value-from":0,"value-style":{color:"rgba(224,33,33,0.85)"},animation:"","show-group-separator":""},null,8,["value","value-style"])]),_:1})]),_:1}),e(B,{class:"panel-col",span:{xs:12,sm:12,md:12,lg:12,xl:12,xxl:6}},{default:t(()=>[e(I,null,{default:t(()=>[e(h,{title:"\u4EFB\u52A1\u6210\u529F\u7387",value:C.value,precision:2,"value-from":0,"value-style":{color:"#2344ec"},animation:"","show-group-separator":""},{suffix:t(()=>[u("%")]),_:1},8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(L,{class:"general-card",title:"\u6267\u884C\u5217\u8868",style:{"margin-top":"10px"}},{default:t(()=>[e(R,{"default-active-key":"1",type:"rounded"},{default:t(()=>[e(a,{key:"1",title:v(O)},{default:t(()=>[v(y)?g("",!0):(o(),D(G,{key:"1","task-id":k.value,status:"SUCCESS"},null,8,["task-id"]))]),_:1},8,["title"]),e(a,{key:"2",title:v(P)},{default:t(()=>[v(y)?g("",!0):(o(),D(G,{key:"2","task-id":k.value,status:"FAIL"},null,8,["task-id"]))]),_:1},8,["title"]),e(a,{key:"3",title:v(M)},{default:t(()=>[v(y)?g("",!0):(o(),D(G,{key:"3","task-id":k.value,status:"RUNNING"},null,8,["task-id"]))]),_:1},8,["title"]),e(a,{key:"4",title:"\u6392\u961F"},{default:t(()=>[v(y)?g("",!0):(o(),D(G,{key:"4","task-id":k.value,status:"INIT"},null,8,["task-id"]))]),_:1})]),_:1})]),_:1})])}}});const Et=ie(Ye,[["__scopeId","data-v-81914a93"]]);export{Et as default};
